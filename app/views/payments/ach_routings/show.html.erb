<div class="max-w-5xl mx-auto p-4 space-y-4">
  <!-- Header -->
  <div class="flex items-start justify-between gap-4">
    <h1 class="text-2xl font-semibold"><%= @routing.customer_name %></h1>
    <div class="mt-1 flex flex-wrap items-center gap-2 text-sm">
    <span class="badge badge-outline font-mono">RTN <%= @routing.routing_number %></span>
    <% if @routing.routing_changed? %>
    <span class="badge badge-warning badge-sm ml-1">Changed</span>
    <% end %>
    <!-- <span class="badge"><%= @routing.city %>, <%= @routing.state_code %></span> -->
    <% if (b = @routing.frb_branch) %>
        <span class="badge badge-info">FRB: <%= b.city %></span>
    <% end %>
    </div>
    <div class="flex gap-2">
    <%= link_to "Back",
                payments_ach_routings_path(request.query_parameters.except(:controller,:action,:public_id)),
                class: "btn btn-ghost" %>

    <%= link_to "Edit",
                edit_payments_ach_routing_path(@routing),
                class: "btn btn-primary" %>

    <%= link_to "All Routings",
                payments_ach_routings_path,
                class: "btn" %>
    </div>
  </div>

  <!-- Contact -->
  <div class="grid md:grid-cols-2 gap-4">
    <div class="card bg-base-100 shadow">
      <div class="card-body">
        <h2 class="card-title">Contact</h2>
        <div class="text-sm space-y-1">
          <div><%= @routing.address %></div>
          <div><%= @routing.city %>, <%= @routing.state_code %> <%= @routing.zip_code %></div>
          <% if @routing.phone_number.present? %>
            <div class="flex items-center gap-2">
              <span class="opacity-70">Phone</span>
              <span class="font-mono"><%= number_to_phone(@routing.phone_number) %></span>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Flags and Notes -->
    <div class="card bg-base-100 shadow">
      <div class="card-body">
        <h2 class="card-title">Flags & Notes</h2>
        <div class="flex flex-wrap gap-2">
        <% @routing.flags.each do |label, klass| %>
            <span class="badge <%= klass %>"><%= label %></span>
        <% end %>
        <% if @routing.flags.empty? %>
            <span class="opacity-70 text-sm">No special flags</span>
        <% end %>
        </div>

        <% if @routing.respond_to?(:notes) && @routing.notes.present? %>
        <div class="mt-3">
            <div class="opacity-70 text-sm mb-1">Notes</div>
            <div class="prose max-w-none text-sm whitespace-pre-wrap"><%= simple_format(h(@routing.notes)) %></div>
        </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- FRB details -->
  <%= render "frb_details", routing: @routing %>

  <!-- Raw record -->
  <details class="collapse bg-base-200">
    <summary class="collapse-title text-sm">Raw record</summary>
    <div class="collapse-content">
      <pre class="text-xs overflow-x-auto"><%= JSON.pretty_generate(@routing.attributes) %></pre>
    </div>
  </details>
</div>
